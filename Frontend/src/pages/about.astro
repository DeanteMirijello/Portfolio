---
import Nav from "../components/nav.astro";
const API_BASE_VALUE = import.meta.env.PUBLIC_API_BASE || "http://localhost:3001";
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/styles/global.css" />
    <link rel="stylesheet" href="/styles/about.css" />
    <!-- Favicon: place files in Frontend/public/ -->
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <title>About | Deante Mirijello</title>
  </head>

  <body>
    <Nav />

    <main data-api-base={API_BASE_VALUE}>
      <header class="page-header">
        <h1 data-i18n="about.title">About Me</h1>
        <p data-i18n="about.intro">
          I’m Deante Mirijello, a Computer Science student in Montreal. I’m interested in
          full-stack development and building practical software.
        </p>
      </header>

      <section class="about-grid">
        <article class="about-card">
          <h2>Who I Am</h2>
          <p>
            I’m Deante Mirijello, a Computer Science student in Montreal. I enjoy
            building practical software and learning across the stack.
          </p>
          <div class="about-actions">
            <a href="/assets/resume.pdf" download class="lang-btn">Download Resume</a>
          </div>
        </article>

        <article class="about-card">
          <h2>Work Experience</h2>
          <div class="info-row">
            <div>
              <h3>Costco — Stocker</h3>
              <p class="muted">Jun 2023 – Present</p>
            </div>
          </div>
          <ul class="clean-list">
            <li>Collaborated on inventory and aisle organization.</li>
            <li>Helped customers in English and French.</li>
            <li>Supported and guided new team members.</li>
          </ul>

          <div class="divider"></div>

          <h2>Contact Information</h2>
          <section class="contact-card" id="contactCard" hidden>
            <div id="contactItems"></div>
          </section>
        </article>
      </section>
    </main>
    <script type="module">
      const API_BASE = document.querySelector("main").dataset.apiBase;
      const CONTACT_API = `${API_BASE}/contact/items`;
      const contactCard = document.getElementById("contactCard");
      const itemsDiv = document.getElementById("contactItems");

      function renderContact(items) {
        itemsDiv.innerHTML = "";
        if (!items.length) {
          itemsDiv.innerHTML = '<p class="muted">No contact information yet.</p>';
          return;
        }
        for (const item of items) {
          const row = document.createElement("div");
          row.className = "contact-row";
          const label = document.createElement("span");
          label.className = "contact-label";
          label.textContent = item.title;
          const valueCell = document.createElement("div");
          const v = item.value || "";
          const isEmail = v.includes("@") && !/^https?:\/\//i.test(v);
          const isUrl = /^https?:\/\//i.test(v);
          if (isEmail || isUrl) {
            const a = document.createElement("a");
            a.className = "contact-link";
            a.href = isEmail ? `mailto:${v}` : v;
            a.target = "_blank";
            a.rel = "noreferrer";
            a.textContent = isEmail ? v : v.replace(/^https?:\/\//i, "");
            valueCell.appendChild(a);
          } else {
            const span = document.createElement("span");
            span.className = "contact-value";
            span.textContent = v;
            valueCell.appendChild(span);
          }
          row.appendChild(label);
          row.appendChild(valueCell);
          itemsDiv.appendChild(row);
        }
      }

      async function loadContact() {
        try {
          const res = await fetch(CONTACT_API);
          const items = await res.json();
          renderContact(items);
          contactCard.hidden = false;
        } catch (e) {
          console.error(e);
        }
      }

      loadContact();
    </script>
    <script type="module" src="/js/i18n.js"></script>
  </body>
</html>
